<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head profile="http://www.w3.org/2006/03/hcard http://dublincore.org/documents/2008/08/04/dc-html/">
  <meta http-equiv="Content-Type" content="text/html; charset=us-ascii" />

  <title>Protocol Independent Encoding for Signaling Flow Characteristics</title>

  <style type="text/css" title="Xml2Rfc (sans serif)">
  /*<![CDATA[*/
	  a {
	  text-decoration: none;
	  }
      /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
      a.info {
          /* This is the key. */
          position: relative;
          z-index: 24;
          text-decoration: none;
      }
      a.info:hover {
          z-index: 25;
          color: #FFF; background-color: #900;
      }
      a.info span { display: none; }
      a.info:hover span.info {
          /* The span will display just on :hover state. */
          display: block;
          position: absolute;
          font-size: smaller;
          top: 2em; left: -5em; width: 15em;
          padding: 2px; border: 1px solid #333;
          color: #900; background-color: #EEE;
          text-align: left;
      }
	  a.smpl {
	  color: black;
	  }
	  a:hover {
	  text-decoration: underline;
	  }
	  a:active {
	  text-decoration: underline;
	  }
	  address {
	  margin-top: 1em;
	  margin-left: 2em;
	  font-style: normal;
	  }
	  body {
	  color: black;
	  font-family: verdana, helvetica, arial, sans-serif;
	  font-size: 10pt;
	  max-width: 55em;
	  
	  }
	  cite {
	  font-style: normal;
	  }
	  dd {
	  margin-right: 2em;
	  }
	  dl {
	  margin-left: 2em;
	  }
	
	  ul.empty {
	  list-style-type: none;
	  }
	  ul.empty li {
	  margin-top: .5em;
	  }
	  dl p {
	  margin-left: 0em;
	  }
	  dt {
	  margin-top: .5em;
	  }
	  h1 {
	  font-size: 14pt;
	  line-height: 21pt;
	  page-break-after: avoid;
	  }
	  h1.np {
	  page-break-before: always;
	  }
	  h1 a {
	  color: #333333;
	  }
	  h2 {
	  font-size: 12pt;
	  line-height: 15pt;
	  page-break-after: avoid;
	  }
	  h3, h4, h5, h6 {
	  font-size: 10pt;
	  page-break-after: avoid;
	  }
	  h2 a, h3 a, h4 a, h5 a, h6 a {
	  color: black;
	  }
	  img {
	  margin-left: 3em;
	  }
	  li {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol p {
	  margin-left: 0em;
	  }
	  p {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  pre {
	  margin-left: 3em;
	  background-color: lightyellow;
	  padding: .25em;
	  }
	  pre.text2 {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f0f0f0;
	  width: 69em;
	  }
	  pre.inline {
	  background-color: white;
	  padding: 0em;
	  }
	  pre.text {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  width: 69em;
	  }
	  pre.drawing {
	  border-style: solid;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  padding: 2em;
	  }
	  table {
	  margin-left: 2em;
	  }
	  table.tt {
	  vertical-align: top;
	  }
	  table.full {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.headers {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.tt td {
	  vertical-align: top;
	  }
	  table.full td {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.tt th {
	  vertical-align: top;
	  }
	  table.full th {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.headers th {
	  border-style: none none inset none;
	  border-width: 1px;
	  }
	  table.left {
	  margin-right: auto;
	  }
	  table.right {
	  margin-left: auto;
	  }
	  table.center {
	  margin-left: auto;
	  margin-right: auto;
	  }
	  caption {
	  caption-side: bottom;
	  font-weight: bold;
	  font-size: 9pt;
	  margin-top: .5em;
	  }
	
	  table.header {
	  border-spacing: 1px;
	  width: 95%;
	  font-size: 10pt;
	  color: white;
	  }
	  td.top {
	  vertical-align: top;
	  }
	  td.topnowrap {
	  vertical-align: top;
	  white-space: nowrap; 
	  }
	  table.header td {
	  background-color: gray;
	  width: 50%;
	  }
	  table.header a {
	  color: white;
	  }
	  td.reference {
	  vertical-align: top;
	  white-space: nowrap;
	  padding-right: 1em;
	  }
	  thead {
	  display:table-header-group;
	  }
	  ul.toc, ul.toc ul {
	  list-style: none;
	  margin-left: 1.5em;
	  margin-right: 0em;
	  padding-left: 0em;
	  }
	  ul.toc li {
	  line-height: 150%;
	  font-weight: bold;
	  font-size: 10pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  ul.toc li li {
	  line-height: normal;
	  font-weight: normal;
	  font-size: 9pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  li.excluded {
	  font-size: 0pt;
	  }
	  ul p {
	  margin-left: 0em;
	  }
	
	  .comment {
	  background-color: yellow;
	  }
	  .center {
	  text-align: center;
	  }
	  .error {
	  color: red;
	  font-style: italic;
	  font-weight: bold;
	  }
	  .figure {
	  font-weight: bold;
	  text-align: center;
	  font-size: 9pt;
	  }
	  .filename {
	  color: #333333;
	  font-weight: bold;
	  font-size: 12pt;
	  line-height: 21pt;
	  text-align: center;
	  }
	  .fn {
	  font-weight: bold;
	  }
	  .hidden {
	  display: none;
	  }
	  .left {
	  text-align: left;
	  }
	  .right {
	  text-align: right;
	  }
	  .title {
	  color: #990000;
	  font-size: 18pt;
	  line-height: 18pt;
	  font-weight: bold;
	  text-align: center;
	  margin-top: 36pt;
	  }
	  .vcardline {
	  display: block;
	  }
	  .warning {
	  font-size: 14pt;
	  background-color: yellow;
	  }
	
	
	  @media print {
	  .noprint {
		display: none;
	  }
	
	  a {
		color: black;
		text-decoration: none;
	  }
	
	  table.header {
		width: 90%;
	  }
	
	  td.header {
		width: 50%;
		color: black;
		background-color: white;
		vertical-align: top;
		font-size: 12pt;
	  }
	
	  ul.toc a::after {
		content: leader('.') target-counter(attr(href), page);
	  }
	
	  ul.ind li li a {
		content: target-counter(attr(href), page);
	  }
	
	  .print2col {
		column-count: 2;
		-moz-column-count: 2;
		column-fill: auto;
	  }
	  }
	
	  @page {
	  @top-left {
		   content: "Internet-Draft"; 
	  } 
	  @top-right {
		   content: "December 2010"; 
	  } 
	  @top-center {
		   content: "Abbreviated Title";
	  } 
	  @bottom-left {
		   content: "Doe"; 
	  } 
	  @bottom-center {
		   content: "Expires June 2011"; 
	  } 
	  @bottom-right {
		   content: "[Page " counter(page) "]"; 
	  } 
	  }
	
	  @page:first { 
		@top-left {
		  content: normal;
		}
		@top-right {
		  content: normal;
		}
		@top-center {
		  content: normal;
		}
	  }
  /*]]>*/
  </style>

  <link href="#rfc.toc" rel="Contents"/>
<link href="#rfc.section.1" rel="Chapter" title="1 Introduction"/>
<link href="#rfc.section.1.1" rel="Chapter" title="1.1 Requirements Language"/>
<link href="#rfc.section.2" rel="Chapter" title="2 Encoding Overview"/>
<link href="#rfc.section.2.1" rel="Chapter" title="2.1 General Principles"/>
<link href="#rfc.section.2.2" rel="Chapter" title="2.2 Encoding Goals"/>
<link href="#rfc.section.2.2.1" rel="Chapter" title="2.2.1 Transport independence"/>
<link href="#rfc.section.2.2.2" rel="Chapter" title="2.2.2 Standard and Vendor Specific Namespaces"/>
<link href="#rfc.section.2.2.3" rel="Chapter" title="2.2.3 Multiple Producers"/>
<link href="#rfc.section.2.2.4" rel="Chapter" title="2.2.4 Upstream and Downstream"/>
<link href="#rfc.section.2.2.5" rel="Chapter" title="2.2.5 Application to Network and Network to Application"/>
<link href="#rfc.section.2.2.6" rel="Chapter" title="2.2.6 Extensibility"/>
<link href="#rfc.section.2.2.7" rel="Chapter" title="2.2.7 Flexibility"/>
<link href="#rfc.section.2.2.8" rel="Chapter" title="2.2.8 Per Producer Security"/>
<link href="#rfc.section.2.2.9" rel="Chapter" title="2.2.9 Compact Encoding"/>
<link href="#rfc.section.3" rel="Chapter" title="3 Encoding specification"/>
<link href="#rfc.section.3.1" rel="Chapter" title="3.1 Layout"/>
<link href="#rfc.section.3.1.1" rel="Chapter" title="3.1.1 Sections"/>
<link href="#rfc.section.3.1.2" rel="Chapter" title="3.1.2 Security Tokens"/>
<link href="#rfc.section.3.1.3" rel="Chapter" title="3.1.3 Subsections"/>
<link href="#rfc.section.3.1.4" rel="Chapter" title="3.1.4 Upstream and Downstream  Blocks"/>
<link href="#rfc.section.3.1.5" rel="Chapter" title="3.1.5 Complete Encoding Example"/>
<link href="#rfc.section.3.1.6" rel="Chapter" title="3.1.6 Compact Encoding Example"/>
<link href="#rfc.section.3.2" rel="Chapter" title="3.2 Encoding Structures"/>
<link href="#rfc.section.3.3" rel="Chapter" title="3.3 ABNF"/>
<link href="#rfc.section.4" rel="Chapter" title="4 Security Considerations"/>
<link href="#rfc.section.5" rel="Chapter" title="5 Acknowledgements"/>
<link href="#rfc.references" rel="Chapter" title="6 References"/>
<link href="#rfc.references.1" rel="Chapter" title="6.1 Normative References"/>
<link href="#rfc.references.2" rel="Chapter" title="6.2 Informative References"/>
<link href="#rfc.appendix.A" rel="Chapter" title="A Encoding usage examples"/>
<link href="#rfc.authors" rel="Chapter"/>


  <meta name="generator" content="xml2rfc version 2.4.5 - http://tools.ietf.org/tools/xml2rfc" />
  <link rel="schema.dct" href="http://purl.org/dc/terms/" />

  <meta name="dct.creator" content="Eckert, T., Ed., Zamfir, A., Choukir, A., and C. Eckel" />
  <meta name="dct.identifier" content="urn:ietf:id:draft-choukir-tsvwg-flow-metadata-encoding-01" />
  <meta name="dct.issued" scheme="ISO8601" content="2014-1-8" />
  <meta name="dct.abstract" content="This document describes a protocol independent encoding for flow characteristics (a.k.a. metadata). A flow is defined as a set of IP packets passing through a network in a given direction. All packets belonging to a particular flow have a set of common properties (e.g. IP, port, transport). Flow metadata exposes key characteristics of the flow such as the originating application, the type of media in use (e.g.  audio, video) and others as defined in " />
  <meta name="description" content="This document describes a protocol independent encoding for flow characteristics (a.k.a. metadata). A flow is defined as a set of IP packets passing through a network in a given direction. All packets belonging to a particular flow have a set of common properties (e.g. IP, port, transport). Flow metadata exposes key characteristics of the flow such as the originating application, the type of media in use (e.g.  audio, video) and others as defined in " />

</head>

<body>

  <table class="header">
    <tbody>
    
    	<tr>
  <td class="left">Internet Engineering Task Force</td>
  <td class="right">T. Eckert, Ed.</td>
</tr>
<tr>
  <td class="left">Internet-Draft</td>
  <td class="right">A. Zamfir</td>
</tr>
<tr>
  <td class="left">Intended status: Standards Track</td>
  <td class="right">A. Choukir</td>
</tr>
<tr>
  <td class="left">Expires: July 12, 2014</td>
  <td class="right">C. Eckel</td>
</tr>
<tr>
  <td class="left"></td>
  <td class="right">Cisco Systems, Inc.</td>
</tr>
<tr>
  <td class="left"></td>
  <td class="right">January 8, 2014</td>
</tr>

    	
    </tbody>
  </table>

  <p class="title">Protocol Independent Encoding for Signaling Flow Characteristics<br />
  <span class="filename">draft-choukir-tsvwg-flow-metadata-encoding-01</span></p>
  
  <h1 id="rfc.abstract">
  <a href="#rfc.abstract">Abstract</a>
</h1>
<p>This document describes a protocol independent encoding for flow characteristics (a.k.a. metadata). A flow is defined as a set of IP packets passing through a network in a given direction. All packets belonging to a particular flow have a set of common properties (e.g. IP, port, transport). Flow metadata exposes key characteristics of the flow such as the originating application, the type of media in use (e.g.  audio, video) and others as defined in <a href="#I-D.eckert-intarea-flow-metadata-framework">[I-D.eckert-intarea-flow-metadata-framework]</a>. The flow characteristics are expressed in terms of information elements. These information elements are signaled either out of band or in band but always along the same path of the flow associated with the application.</p>
<p><a href="#I-D.eckert-intarea-flow-metadata-framework">[I-D.eckert-intarea-flow-metadata-framework]</a> defines the overall framework for flow metadata and the definition of the flow characteristics, whereas this document captures the encoding of these characteristics. The mapping of flow metadata encoding to different signaling protocols is outside the scope of this document.</p>
<h1 id="rfc.status">
  <a href="#rfc.status">Status of This Memo</a>
</h1>
<p>This Internet-Draft is submitted in full conformance with the provisions of BCP 78 and BCP 79.</p>
<p>Internet-Drafts are working documents of the Internet Engineering Task Force (IETF).  Note that other groups may also distribute working documents as Internet-Drafts.  The list of current Internet-Drafts is at http://datatracker.ietf.org/drafts/current/.</p>
<p>Internet-Drafts are draft documents valid for a maximum of six months and may be updated, replaced, or obsoleted by other documents at any time.  It is inappropriate to use Internet-Drafts as reference material or to cite them other than as "work in progress."</p>
<p>This Internet-Draft will expire on July 12, 2014.</p>
<h1 id="rfc.copyrightnotice">
  <a href="#rfc.copyrightnotice">Copyright Notice</a>
</h1>
<p>Copyright (c) 2014 IETF Trust and the persons identified as the document authors.  All rights reserved.</p>
<p>This document is subject to BCP 78 and the IETF Trust's Legal Provisions Relating to IETF Documents (http://trustee.ietf.org/license-info) in effect on the date of publication of this document.  Please review these documents carefully, as they describe your rights and restrictions with respect to this document.  Code Components extracted from this document must include Simplified BSD License text as described in Section 4.e of the Trust Legal Provisions and are provided without warranty as described in the Simplified BSD License.</p>

  
  <hr class="noprint" />
  <h1 class="np" id="rfc.toc"><a href="#rfc.toc">Table of Contents</a></h1>
  <ul class="toc">

  	<li>1.   <a href="#rfc.section.1">Introduction</a></li>
<li>1.1.   <a href="#rfc.section.1.1">Requirements Language</a></li>
<li>2.   <a href="#rfc.section.2">Encoding Overview</a></li>
<li>2.1.   <a href="#rfc.section.2.1">General Principles</a></li>
<li>2.2.   <a href="#rfc.section.2.2">Encoding Goals</a></li>
<li>2.2.1.   <a href="#rfc.section.2.2.1">Transport independence</a></li>
<li>2.2.2.   <a href="#rfc.section.2.2.2">Standard and Vendor Specific Namespaces</a></li>
<li>2.2.3.   <a href="#rfc.section.2.2.3">Multiple Producers</a></li>
<li>2.2.4.   <a href="#rfc.section.2.2.4">Upstream and Downstream</a></li>
<li>2.2.5.   <a href="#rfc.section.2.2.5">Application to Network and Network to Application</a></li>
<li>2.2.6.   <a href="#rfc.section.2.2.6">Extensibility</a></li>
<li>2.2.7.   <a href="#rfc.section.2.2.7">Flexibility</a></li>
<li>2.2.8.   <a href="#rfc.section.2.2.8">Per Producer Security</a></li>
<li>2.2.9.   <a href="#rfc.section.2.2.9">Compact Encoding</a></li>
<li>3.   <a href="#rfc.section.3">Encoding specification</a></li>
<li>3.1.   <a href="#rfc.section.3.1">Layout</a></li>
<li>3.1.1.   <a href="#rfc.section.3.1.1">Sections</a></li>
<li>3.1.2.   <a href="#rfc.section.3.1.2">Security Tokens</a></li>
<li>3.1.3.   <a href="#rfc.section.3.1.3">Subsections</a></li>
<li>3.1.4.   <a href="#rfc.section.3.1.4">Upstream and Downstream  Blocks</a></li>
<li>3.1.5.   <a href="#rfc.section.3.1.5">Complete Encoding Example</a></li>
<li>3.1.6.   <a href="#rfc.section.3.1.6">Compact Encoding Example</a></li>
<li>3.2.   <a href="#rfc.section.3.2">Encoding Structures</a></li>
<li>3.3.   <a href="#rfc.section.3.3">ABNF</a></li>
<li>4.   <a href="#rfc.section.4">Security Considerations</a></li>
<li>5.   <a href="#rfc.section.5">Acknowledgements</a></li>
<li>6.   <a href="#rfc.references">References</a></li>
<li>6.1.   <a href="#rfc.references.1">Normative References</a></li>
<li>6.2.   <a href="#rfc.references.2">Informative References</a></li>
<li>Appendix A.   <a href="#rfc.appendix.A">Encoding usage examples</a></li>
<li><a href="#rfc.authors">Authors' Addresses</a></li>


  </ul>

  <h1 id="rfc.section.1"><a href="#rfc.section.1">1.</a> Introduction</h1>
<p id="rfc.section.1.p.1">This document describes a protocol independent encoding for flow characteristics (a.k.a. metadata). A flow is defined as a set of IP packets passing through a network in a given direction. All packets belonging to a particular flow have a set of common properties (e.g. IP, port, transport). Flow metadata exposes key characteristics of the flow such as the originating application, the type of media in use (e.g.  audio, video) and others as defined in <a href="#I-D.eckert-intarea-flow-metadata-framework">[I-D.eckert-intarea-flow-metadata-framework]</a>. The flow characteristics are expressed in terms of information elements. These information elements are signaled either out of band or in band but always along the same path of the flow associated with the application.</p>
<p id="rfc.section.1.p.2">As flow characteristics across different signaling protocols are identical, they benefit from a single definition and encoding irrespective of the signaling protocol in use (e.g. RSVP <a href="#I-D.zamfir-tsvwg-flow-metadata-rsvp">[I-D.zamfir-tsvwg-flow-metadata-rsvp]</a>, STUN <a href="#I-D.martinsen-mmusic-malice">[I-D.martinsen-mmusic-malice]</a>, and PCP <a href="#I-D.wing-pcp-flowdata">[I-D.wing-pcp-flowdata]</a>). Different network deployments call for different protocols or combination of protocols as described in <a href="#I-D.eckert-intarea-flow-metadata-framework">[I-D.eckert-intarea-flow-metadata-framework]</a>. The flow characteristics can be processed by intermediate network nodes for the purpose of applying a particular treatment to the flow or simply for gathering insight on the nature of the traffic crossing the network node.</p>
<p id="rfc.section.1.p.3">Flows, and the corresponding metadata, are inherently unidirectional, in the direction from the source to the destination (e.g. from Alice to Bob). In some cases, there may be a related flow in the reverse direction (e.g. from Bob to Alice), but this is treated as a separate flow, not a bidirectional flow. The metadata can characterize data in the same direction as the flow (upstream) or in the opposite direction (downstream). The encoding mechanism enabling signaling for either or both directions. The metadata can be signaled by the application itself and/or by network elements that have visibility of the flow data. The encoding supports distinguishing between attribute information originated by an application from attribute information originated by a network device. The encoding allows to segregates information coming from the application from information coming from the network.</p>
<h1 id="rfc.section.1.1"><a href="#rfc.section.1.1">1.1.</a> Requirements Language</h1>
<p id="rfc.section.1.1.p.1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in <a href="#RFC2119">[RFC2119]</a>.</p>
<h1 id="rfc.section.2"><a href="#rfc.section.2">2.</a> Encoding Overview</h1>
<h1 id="rfc.section.2.1"><a href="#rfc.section.2.1">2.1.</a> General Principles</h1>
<p id="rfc.section.2.1.p.1">This specification assumes that the flow is specified by the transport protocol which carries the metadata. As an example, in STUN, flow identifiers such as IP addresses and ports are present in layer 3 and 4 headers of STUN messages (see <a href="#I-D.martinsen-mmusic-malice">[I-D.martinsen-mmusic-malice]</a>). In RSVP, the same is obtained from the SESSION and SENDER-TEMPLATE objects (see <a href="#I-D.zamfir-tsvwg-flow-metadata-rsvp">[I-D.zamfir-tsvwg-flow-metadata-rsvp]</a>). In PCP the source IP is part of the request common header; other flow identifiers need to be embedded in an opcode data or an option (see<a href="#I-D.wing-pcp-flowdata">[I-D.wing-pcp-flowdata]</a>).</p>
<p id="rfc.section.2.1.p.2">The Flow Metadata characteristics are to be interpreted in the context of the flow defined by the signaling protocol. In this specification Flow Metadata encoding does not carry any flow identifiers but merely the flow characteristics. The specification could be extended to carry the flow identifiers if needed.</p>
<p id="rfc.section.2.1.p.3">The encoding defined herein does not relate to any specific signaling but rather allows different signaling protocols to transport flow characteristics. As the encoding is shared amongst several protocols, it is versioned independently to allow, if needed, its evolution without impacting the signaling protocol.</p>
<h1 id="rfc.section.2.2"><a href="#rfc.section.2.2">2.2.</a> Encoding Goals</h1>
<p id="rfc.section.2.2.p.1">The following goals have been considered in the design of the encoding:</p>

<ul>
  <li>Transport independence</li>
  <li>Allow for a standard namespace as well as vendor specific namespaces</li>
  <li>Support multiple producers of flow characteristics</li>
  <li>Ability to encode flow characteristics for both the flow itself (upstream) and the flow in the reverse direction (downstream).</li>
  <li>Ability to communicate flow characteristics from an application to the network as well as from the network back to the application</li>
  <li>Extensibility while allowing for backwards compatibility</li>
  <li>Flexibility</li>
  <li>Support for integrity, authentication and authorization on a per producer basis</li>
  <li>Compact encoding</li>
</ul>
<h1 id="rfc.section.2.2.1"><a href="#rfc.section.2.2.1">2.2.1.</a> Transport independence</h1>
<p id="rfc.section.2.2.1.p.1">One goal of this proposal is to provide an encoding that can be used by more than one transport protocol. This should help maintain consistency across standardization of flow metadata usage by various signaling protocols, and it should simplify implementations that make use of different signaling protocols when transporting flow metadata. One example is an application that may use different signaling protocols depending on the environment, peer protocol support, etc. Another is a middlebox on an administrative boundary that may need to perform protocol interworking functions.</p>
<h1 id="rfc.section.2.2.2"><a href="#rfc.section.2.2.2">2.2.2.</a> Standard and Vendor Specific Namespaces</h1>
<p id="rfc.section.2.2.2.p.1">Vendors need the ability to define and use proprietary Metadata when they are delivering a pre-standard feature or product or when the encoded information is of commercially sensitive nature. This specification provides support for both standard and vendor specific defined flow characteristics.</p>
<h1 id="rfc.section.2.2.3"><a href="#rfc.section.2.2.3">2.2.3.</a> Multiple Producers</h1>
<p id="rfc.section.2.2.3.p.1">Multiple producers may contribute flow characteristics to the Flow Metadata information associated with a given flow.</p>
<p id="rfc.section.2.2.3.p.2">Applications are one category of candidates for generating Flow Metadata as they have precise knowledge of the flows they insert into the network. Middleboxes constitute a second class of Metadata producers. Deep Packet Inspection engines are deployed to recognize the originator and nature of the flows traversing a network. Media Termination Points (e.g. MCU, transcoders) are deployed to offer additional services to applications. Media Termination Points have knowledge of the transformations they apply on the flow they receive and can therefore update the characteristics of the flow. Other proxies and gateways exist for other applications and could produce information in relation to the flow.</p>
<h1 id="rfc.section.2.2.4"><a href="#rfc.section.2.2.4">2.2.4.</a> Upstream and Downstream</h1>
<p id="rfc.section.2.2.4.p.1">As explained in the introduction, a flow is unidirectional by definition, but some use cases and signaling protocols require or allow to signal both upstream and downstream flow characteristics.  For example, in the context of a home user that needs to prioritize its upstream and downstream flow an end-to-edge protocol can expose flow characteristics to the edge ISP node controlling its access link for both its upstream and downstream flow. This allows the edge node to apply proper treatment to both directions.</p>
<h1 id="rfc.section.2.2.5"><a href="#rfc.section.2.2.5">2.2.5.</a> Application to Network and Network to Application</h1>
<p id="rfc.section.2.2.5.p.1">In accordance with <a href="#I-D.eckert-intarea-flow-metadata-framework">[I-D.eckert-intarea-flow-metadata-framework]</a>, flow characteristics may be communicated both from application to network as well as from network to application. The encoding rules are the same regardless of the direction of the communication. The ability to differentiate between the two is provided by the transport protocol. For example, when using PCP, application to network communication is via a PCP request, and network to application communication is via a PCP response.</p>
<h1 id="rfc.section.2.2.6"><a href="#rfc.section.2.2.6">2.2.6.</a> Extensibility</h1>
<p id="rfc.section.2.2.6.p.1">New use cases and new deployment scenarios will require the use of new flow characteristics. For this reason the encoding should support new metadata (i.e. new information elements) in a backwards compatible way. New information element definitions supplement but do not redefine existing definitions. An application or a network node always signals its currently supported set of information elements and devices leverage the subset they understand for the purpose of applying treatment to, or gathering information about, the application flows.</p>
<h1 id="rfc.section.2.2.7"><a href="#rfc.section.2.2.7">2.2.7.</a> Flexibility</h1>
<p id="rfc.section.2.2.7.p.1">Distinct use cases and individual applications have a need for different subsets of information elements. The encoding should support the signaling of any subset of information elements for that purpose. For example, a video conferencing application might need to signal metadata for both its audio and video flows. A video surveillance application might signal video flows only, but may need to indicate which one has priority based on embedded analytics.</p>
<h1 id="rfc.section.2.2.8"><a href="#rfc.section.2.2.8">2.2.8.</a> Per Producer Security</h1>
<p id="rfc.section.2.2.8.p.1">Treatment applied on the basis of metadata may involve the consumption of scarce network resources and therefore contribute to their exhaustion. Consequently, integrity, authentication, and authorization are all important aspects of any security mechanism used to secure the metadata.</p>
<p id="rfc.section.2.2.8.p.2">This specification defines an optional security element container; however, the actual security mechanism to be used is outside the scope of this specification.</p>
<h1 id="rfc.section.2.2.9"><a href="#rfc.section.2.2.9">2.2.9.</a> Compact Encoding</h1>
<p id="rfc.section.2.2.9.p.1">One of the goals of the encoding described in this specification is to be compact and consume minimal space in the signaling protocol payload. Most of the protocols have limited space for Metadata purposes and do not support semantic fragmentation. The strategy of the encoding is to minimize the encoding structures used for the common signaling case. The common case is foreseen to be the application signaling standard flow characteristics.</p>
<h1 id="rfc.section.3"><a href="#rfc.section.3">3.</a> Encoding specification</h1>
<h1 id="rfc.section.3.1"><a href="#rfc.section.3.1">3.1.</a> Layout</h1>
<p id="rfc.section.3.1.p.1">This section describes the encoding layout proposed by this specification. It describes the following: </p>

<ul>
  <li>How the application and network producers coexist using sections in <a href="#encoding_section">Figure 1</a></li>
  <li>Application of an optional security token to a section in <a href="#encoding_security_token">Figure 2</a></li>
  <li>The division of a section into standard and vendor specific sub-sections in <a href="#encoding_section_content">Figure 3</a></li>
  <li>The division of a sub-section into upstream and downstream blocks in <a href="#encoding_subsection_content">Figure 4</a></li>
  <li>A full example using all the encoding building blocks in <a href="#encoding_layout">Figure 5</a></li>
</ul>
<h1 id="rfc.section.3.1.1"><a href="#rfc.section.3.1.1">3.1.1.</a> Sections</h1>
<p id="rfc.section.3.1.1.p.1">The flow characteristics are grouped in sections within the encoding. A section pertains to an application or to a network producer. To segregate application and network producer sections the encoding uses a network marker. The application section does not use a network marker and therefore must come first if present. The encoding MUST contain at least an application or a network section.  <a href="#encoding_section">Figure 1</a> shows an example that contains an application section and two network sections.</p>
<div id="rfc.figure.1"/>
<div id="encoding_section"/>
<pre>
+--------------------------------+
|      Application Section       |
+--------------------------------+
+--------------------------------+
|         Network-1 Marker       |
+--------------------------------+
+--------------------------------+
|                                |
|                                |
|         Network-1 Section      |
|                                |
+--------------------------------+
+--------------------------------+
|         Network-2 Marker       |
+--------------------------------+
+--------------------------------+
|                                |
|                                |
|         Network-2 Section      |
|                                |
|                                |
|                                |
+--------------------------------+
                    </pre>
<p class="figure">Figure 1: Encoding section</p>
<h1 id="rfc.section.3.1.2"><a href="#rfc.section.3.1.2">3.1.2.</a> <a href="#security_tokens" id="security_tokens">Security Tokens</a></h1>
<p id="rfc.section.3.1.2.p.1">A section MAY include at most one security token. The security token, if present, MUST appear at the beginning of the section. In the following example, a separate security token is added to each section contained in the previous example.</p>
<div id="rfc.figure.2"/>
<div id="encoding_security_token"/>
<pre>
+--------------------------------+
|         Security Token         |
+--------------------------------+
+--------------------------------+
|      Application Section       |
+--------------------------------+
+--------------------------------+
|         Network-1 Marker       |
+--------------------------------+
+--------------------------------+
|         Security Token N-1     |
+--------------------------------+
+--------------------------------+
|                                |
|                                |
|         Network-1 Section      |
|                                |
+--------------------------------+
+--------------------------------+
|         Network-2 Marker       |
+--------------------------------+
+--------------------------------+
|         Security Token N-2     |
+--------------------------------+
+--------------------------------+
|                                |
|                                |
|         Network-2 Section      |
|                                |
|                                |
|                                |
+--------------------------------+
                    </pre>
<p class="figure">Figure 2: Encoding security tokens</p>
<h1 id="rfc.section.3.1.3"><a href="#rfc.section.3.1.3">3.1.3.</a> Subsections</h1>
<p id="rfc.section.3.1.3.p.1">A section may be divided into standard and vendor sub-sections. A section MUST at least have one subsection. A section MUST contain at most one standard sub-section and can contain multiple vendor subsections for different vendors. A standard and a vendor sub-section are segregated through a vendor marker. The standard subsection does not use the vendor marker and therefore must come first if present. <a href="#encoding_section_content">Figure 3</a> shows a sample section content.</p>
<div id="rfc.figure.3"/>
<div id="encoding_section_content"/>
<pre>
+--------------------------------+
|                                |
|                                |
|      Standard Subsection       |
|                                |
+--------------------------------+
+--------------------------------+
|         Vendor-1 Marker        |
+--------------------------------+
+--------------------------------+
|       Vendor-1 Subsection      |
|                                |
|                                |
|                                |
|                                |
|                                |
+--------------------------------+
+--------------------------------+
|         Vendor-2 Marker        |
+--------------------------------+
+--------------------------------+
|       Vendor-2 Subsection      |
|                                |
|                                |
|                                |
|                                |
|                                |
+--------------------------------+
                    </pre>
<p class="figure">Figure 3: Encoding subsections</p>
<h1 id="rfc.section.3.1.4"><a href="#rfc.section.3.1.4">3.1.4.</a> Upstream and Downstream  Blocks</h1>
<p id="rfc.section.3.1.4.p.1">A subsection MUST contain at least one upstream or downstream block. A subsection contains at most one upstream block and at most one downstream block. Upstream and downstream blocks are composed of metadata tags, with each tag representing an encoding of a specific information element. If the upstream and downstream blocks are both present, the upstream block MUST come first.</p>
<div id="rfc.figure.4"/>
<div id="encoding_subsection_content"/>
<pre>
+--------------------------------+
|          Upstream block        |
| +------------+  +------------+ |
| |  MD tag    |  |  MD tag    | |
| +------------+  +------------+ |
+--------------------------------+
+--------------------------------+
|        Downstream block        |
| +------------+  +------------+ |
| |  MD tag    |  |  MD tag    | |
| +------------+  +------------+ |
+--------------------------------+
                    </pre>
<p class="figure">Figure 4: Encoding upstream and downstream blocks</p>
<p/>
<h1 id="rfc.section.3.1.5"><a href="#rfc.section.3.1.5">3.1.5.</a> Complete Encoding Example</h1>
<p><a href="#encoding_layout">Figure 5</a> shows a complete example combining the application and network sections together with their standard and vendor sub-sections. The metadata tags appearing in a standard and in a vendor sub-section are managed by separate registries. See <a href="#I-D.eckert-intarea-flow-metadata-framework">[I-D.eckert-intarea-flow-metadata-framework]</a> for a full coverage of the information model and how the registries are handled.</p>
<div id="rfc.figure.5"/>
<div id="encoding_layout"/>
<pre>
+--------------------------------+
|         Security Token         |
+--------------------------------+
+--------------------------------+ ^  ^
|          Upstream block        | |  |A
| +------------+  +------------+ | |  |P
| |  MD tag    |  |  MD tag    | | |S |P
| +------------+  +------------+ | |T |L
+--------------------------------+ |D |I
+--------------------------------+ |  |C
|         Downstream block       | |  |A
| +------------+                 | |  |T
| |  MD tag    |                 | |  |I
| +------------+                 | |  |O
+--------------------------------+ v  |N
+--------------------------------+    |
|     Vendor section marker      |    |S
+--------------------------------+    |E
+--------------------------------+ ^  |C
|          Upstream block        | |V |T
| +------------+  +------------+ | |N |I
| |  MD tag    |  |  MD tag    | | |D |O
| +------------+  +------------+ | |  |N
+--------------------------------+ v  v
+--------------------------------+    ^
|     Network section marker     |    |
+--------------------------------+    |
+--------------------------------+    |N
|         Security Token         |    |E
+--------------------------------+    |T
+--------------------------------+    |W
|         Downstream block       |    |O
| +------------+                 |    |R
| |  MD tag    |                 |    |K
| +------------+                 |    |
+--------------------------------+    |
+--------------------------------+    |S
|     Vendor section marker      |    |E
+--------------------------------+    |C
+--------------------------------+    |T
|         Downstream block       |    |I
| +------------+                 |    |O
| |  MD tag    |                 |    |N
| +------------+                 |    |
+--------------------------------+    v
                        </pre>
<p class="figure">Figure 5: Complete encoding example</p>
<h1 id="rfc.section.3.1.6"><a href="#rfc.section.3.1.6">3.1.6.</a> Compact Encoding Example</h1>
<p><a href="#encoding_layout_compact">Figure 6</a> shows an encoding example for flow metadata standard characteristics produced by an application for the upstream (same as 5-tuple) direction. As can be seen in the figure no network marker is used as we are signaling for the application. In the same way there is no vendor marker as we are signaling standard flow characteristics. This example also assumes a use case where no security token is needed. Further examples are given in <a href="#examples">Appendix A</a>.</p>
<div id="rfc.figure.6"/>
<div id="encoding_layout_compact"/>
<pre>
+--------------------------------+
|          Upstream block        |
| +------------+  +------------+ |
| |  MD tag    |  |  MD tag    | |
| +------------+  +------------+ |
+--------------------------------+
                        </pre>
<p class="figure">Figure 6: Compact encoding example</p>
<h1 id="rfc.section.3.2"><a href="#rfc.section.3.2">3.2.</a> Encoding Structures</h1>
<p id="rfc.section.3.2.p.1">This section explores the encoding looking more closely at the encoding structures. </p>

<ul class="empty">
  <li><a href="#encoding_ep_std_struct">Figure 7</a> shows the encoding used by an application using only standard metadata tags.</li>
  <li><a href="#encoding_ep_vnd_struct">Figure 8</a> shows the encoding used by an application using only vendor specific metadata tags.</li>
  <li><a href="#encoding_nt_std_struct">Figure 9</a> shows the encoding for network producers using only standard metadata tags.</li>
</ul>

<p>The three scenarios expose all the encoding structures. These structures may be combined in various ways to support other scenarios.</p>
<p id="rfc.section.3.2.p.2">The encoding makes use of Type Length Value (TLV) as the base building block, plus some level of nesting to create the different encoding structures. The type indicates which encoding structure is in use. In case of a marker, the length gives the size of the marker but not of the delimited section or sub-section.</p>
<p id="rfc.section.3.2.p.3">As explained previously, application and network sections MUST contain at least one standard or vendor sub-section and MAY contain a security token. The value of the security token TLV is broken down in two parts, a security-scheme indicating the security method used and the security-value holding the security payload specific to the security scheme. The definition of the different security schemes and their payloads are left to a separate document.</p>
<p id="rfc.section.3.2.p.4">The value of the upstream and downstream block TLVs are subdivided in metadata tags. Each tag is itself a TLV specifying a flow characteristic. A metadata tag MUST appear only once in an upstream or a downstream block. On the one hand the security token, the upstream and the downstream block, the vendor and network marker types are defined within the same registry. On the other hand the tag types are defined in a separate registry from the enclosing encoding structures.  The separation of the registries is possible as the metadata tags are part of the upstream and downstream block TLV value and therefore do not collide with the encoding structures.</p>
<div id="rfc.figure.7"/>
<div id="encoding_ep_std_struct"/>
<pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+^S
|        Security-type          |             Length            ||E
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+|C
|       Security-scheme         |                               :|
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+                               :|T
:                       Security-value                          :|O
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+vK
|        Upstream-type          |             Length            |  ^U
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+^M|P
|           Tag-type            |             Length            ||D|
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+| |B
:                           Tag-value                           :|T|L
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+v |O
:                            ...                                :  |C
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+  vK
|        Downstream-type        |             Length            |  ^D
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+  |N
|           Tag-type            |             Length            |  |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+  |B
:                           Tag-value                           :  |L
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+  |O
:                            ...                                :  |C
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+  vK
                        </pre>
<p class="figure">Figure 7</p>
<p><a href="#encoding_ep_vnd_struct">Figure 8</a> adds the vendor sub-section marker which starts a vendor section. The vendor marker is a TLV whose type is defined in the same registry as the security token. Its value is the vendor's Private Enterprise Number (PEN) allocated by IANA. The vendor marker does not include the downstream and the upstream block but rather sets the context to interpret them. Multiple vendor sub-sections within the same application or network section are allowed as long as they pertain to different vendors.</p>
<div id="rfc.figure.8"/>
<div id="encoding_ep_vnd_struct"/>
<pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|        Security-type          |             Length            |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|       Security-scheme         |                               :
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+                               :
:                       Security-value                          :
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ ^
|           PEN-type            |             Length            | |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ |
|                            PEN-id                             | |V
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ |E
|        Upstream-type          |             Length            | |N
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ |D
|           Tag-type            |             Length            | |O
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ |R
:                           Tag-value                           : |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ |S
:                            ...                                : |E
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ |C
|        Downstream-type        |             Length            | |T
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ |I
|           Tag-type            |             Length            | |O
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ |N
:                           Tag-value                           : |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ |
:                            ...                                : |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ v
                        </pre>
<p class="figure">Figure 8</p>
<p><a href="#encoding_nt_std_struct">Figure 9</a> adds the network marker that starts a network section. The network marker is a TLV whose type is defined within the same registry as the security token. The value of the network marker is the network precedence that indicates the administrative preference for the network producer flow characteristics. The precedence allows to merge information from different network producers and retain only the preferred one.</p>
<div id="rfc.figure.9"/>
<div id="encoding_nt_std_struct"/>
<pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ ^
|         Network-type          |             Length            | |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ |
|                          Precedence                           | |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ |
|        Security-type          |             Length            | |P
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ |R
|       Security-scheme         |                               : |O
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+                               : |D
:                       Security-value                          : |U
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ |C
|        Upstream-type          |             Length            | |E
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ |R
|           Tag-type            |             Length            | |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ |S
:                           Tag-value                           : |E
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ |C
:                            ...                                : |T
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ |I
|        Downstream-type        |             Length            | |O
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ |N
|           Tag-type            |             Length            | |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ |
:                           Tag-value                           : |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ |
:                            ...                                : |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ v
                        </pre>
<p class="figure">Figure 9</p>
<p id="rfc.section.3.2.p.7">All the constructs above can be combined to signal standard and vendor specific metadata tags for different producers and allow to secure each producer's information independently.</p>
<h1 id="rfc.section.3.3"><a href="#rfc.section.3.3">3.3.</a> ABNF</h1>
<div id="rfc.figure.10"/>
<div id="abnf"/>
<pre>
MD-block = Version (Application-block / 1*Network-block /
(Application-block 1*Network-block))

Network-blocks = Network-tlv Producer-block

Application-block = Producer-block ; For the application we do not
; require the Producer-tlv

Producer-block = [Security-tlv] (Standard-block / 1*Vendor-block /
(Standard-block 1*Vendor-block))

Vendor-blocks = PEN-tlv Flow-block

Standard-block = Flow-block; We do not require the PEN-tlv
; for the standard metadata tags

Flow-block = Upstream-tlv / Downstream-tlv /
(Upstream-tlv Downstream-tlv)
; If both present, upstream must come first

PEN-tlv = PEN-type Length PEN-id

Network-tlv = Network-type Length Precedence

Security-tlv = Security-type Length Security-scheme Security-value

Upstream-tlv = Upstream-type Length Upstream-value

Upstream-value = Attribute-list

Downstream-tlv = Downstream-type Length Downstream-value

Downstream-value = Attribute-list

Attribute-list = 1*(Attribute-tlv)

Attribute-tlv = Tag-type Length Attribute-value

;---------
;TERMINALS
;---------

Version = %x01 ;  NEW-VER will be picked up as the first
;  version of the encoding

PEN-id = 4(OCTET); Private Enterprise Number defined by IANA

Length = 2(OCTET); 16-bit length field

Precedence = 4(OCTET);  Indicates the preferred source of information
; for a producer-type

Security-scheme = OCTET; Type of security used

Security-value =  *(OCTET)
; length of this field must match Length of Security-tlv + 2

Tag-type = 2(OCTET); Value according to IANA/Vendor-specific registry

Producer-type = Zero %x01; The first foreseen producer is MD-NETWORK
; to cover for DPI engines, gateways and others
; Further values may be allocated later


Security-type = Zero %x00 ;

Upstream-type = Zero %x01 ;

Downstream-type = Zero %x02 ;

PEN-type = Zero %x03 ;

Network-type = Zero %x04

Attribute-value = *(OCTET) ;

Zero = %x00
                        </pre>
<p class="figure">Figure 10</p>
<h1 id="rfc.section.4"><a href="#rfc.section.4">4.</a> <a href="#Security" id="Security">Security Considerations</a></h1>
<p id="rfc.section.4.p.1">A security token, as described in <a href="#security_tokens">Section 3.1.2</a>, is a mechanism provided as part of the encoding to protect flow characteristics. A signaling protocol used to transport the encoded metadata may provide additional security mechanisms. The protocol specific and encoding specific security mechanisms may be used in combination to achieve the required level of security.</p>
<h1 id="rfc.section.5"><a href="#rfc.section.5">5.</a> <a href="#Acknowledgements" id="Acknowledgements">Acknowledgements</a></h1>
<p id="rfc.section.5.p.1">We would like to thank Yann Poupet and Davide Cuda for reviewing this document and helping us proof its content. We would also like to express our gratitude to Sergio Mena de la Cruz for contributing ideas, proofing the text and for his work on validating the grammar.</p>
<h1 id="rfc.references"><a href="#rfc.references">6.</a> References</h1>
<h1 id="rfc.references.1"><a href="#rfc.references.1">6.1.</a> Normative References</h1>
<table>
  <tbody>
    <tr>
      <td class="reference">
        <b id="RFC2119">[RFC2119]</b>
      </td>
      <td class="top"><a href="mailto:sob@harvard.edu" title="Harvard University">Bradner, S.</a>, "<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>", BCP 14, RFC 2119, March 1997.</td>
    </tr>
  </tbody>
</table>
<h1 id="rfc.references.2"><a href="#rfc.references.2">6.2.</a> Informative References</h1>
<table>
  <tbody>
    <tr>
      <td class="reference">
        <b id="I-D.eckert-intarea-flow-metadata-framework">[I-D.eckert-intarea-flow-metadata-framework]</b>
      </td>
      <td class="top"><a>Eckert, T.</a>, <a>Penno, R.</a>, <a>Choukir, A.</a> and <a>C. Eckel</a>, "<a href="http://tools.ietf.org/html/draft-eckert-intarea-flow-metadata-framework-02">A Framework for Signaling Flow Characteristics between Applications and the Network</a>", Internet-Draft draft-eckert-intarea-flow-metadata-framework-02, October 2013.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="I-D.martinsen-mmusic-malice">[I-D.martinsen-mmusic-malice]</b>
      </td>
      <td class="top"><a>Penno, R.</a>, <a>Martinsen, P.</a>, <a>Wing, D.</a> and <a>A. Zamfir</a>, "<a href="http://tools.ietf.org/html/draft-martinsen-mmusic-malice-00">Meta-data Attribute signaLling with ICE</a>", Internet-Draft draft-martinsen-mmusic-malice-00, July 2013.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="I-D.wing-pcp-flowdata">[I-D.wing-pcp-flowdata]</b>
      </td>
      <td class="top"><a>Wing, D.</a>, <a>Penno, R.</a> and <a>T. Reddy</a>, "<a href="http://tools.ietf.org/html/draft-wing-pcp-flowdata-00">PCP Flowdata Option</a>", Internet-Draft draft-wing-pcp-flowdata-00, July 2013.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="I-D.zamfir-tsvwg-flow-metadata-rsvp">[I-D.zamfir-tsvwg-flow-metadata-rsvp]</b>
      </td>
      <td class="top"><a>Eckert, T.</a>, <a>Zamfir, A.</a> and <a>A. Choukir</a>, "<a href="http://tools.ietf.org/html/draft-zamfir-tsvwg-flow-metadata-rsvp-00">Flow Metadata Signaling with RSVP</a>", Internet-Draft draft-zamfir-tsvwg-flow-metadata-rsvp-00, July 2013.</td>
    </tr>
  </tbody>
</table>
<h1 id="rfc.appendix.A"><a href="#rfc.appendix.A">Appendix A.</a> <a href="#examples" id="examples">Encoding usage examples</a></h1>
<p id="rfc.section.A.p.1">TBD</p>
<h1 id="rfc.authors">
  <a href="#rfc.authors">Authors' Addresses</a>
</h1>
<div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Toerless Eckert</span> (editor)
	  <span class="n hidden">
		<span class="family-name">Eckert</span>
	  </span>
	</span>
	<span class="org vcardline">Cisco Systems, Inc.</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality">San Jose</span>,  
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline">US</span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:eckert@cisco.com">eckert@cisco.com</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Anca Zamfir</span> 
	  <span class="n hidden">
		<span class="family-name">Zamfir</span>
	  </span>
	</span>
	<span class="org vcardline">Cisco Systems, Inc.</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality">Lausanne</span>,  
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline">CH</span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:ancaz@cisco.com">ancaz@cisco.com</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Amine Choukir</span> 
	  <span class="n hidden">
		<span class="family-name">Choukir</span>
	  </span>
	</span>
	<span class="org vcardline">Cisco Systems, Inc.</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality">Lausanne</span>,  
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline">CH</span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:amchouki@cisco.com">amchouki@cisco.com</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Charles Eckel</span> 
	  <span class="n hidden">
		<span class="family-name">Eckel</span>
	  </span>
	</span>
	<span class="org vcardline">Cisco Systems, Inc.</span>
	<span class="adr">
	  <span class="vcardline">170 West Tasman Drive</span>

	  <span class="vcardline">
		<span class="locality">San Jose</span>,  
		<span class="region">CA</span> 
		<span class="code">95134</span>
	  </span>
	  <span class="country-name vcardline">US</span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:eckelcu@cisco.com">eckelcu@cisco.com</a></span>

  </address>
</div>

</body>
</html>
